# 3 Linux开发环境

## 3.1 Linux简介

### Unix

- Linux源自UNIX，是**类Unix操作系统**
- UNIX操作系统是美国贝尔实验室的Ken.Thompson和Dennis Ritchie于1969年夏在PDP-7上开发的一个操作系统
- Thompson在1969年夏天利用一个月的时间开发了UNIX操作系统的原型。后经Ritchie于1972年用C语言进行了改写，使得UNIX系统在大专院校得到了推广

### GNU

- GNU计划和自由软件基金会FSF(the Free Software Foundation)是由Richard M. Stallman于1984年一手创办的，旨在创造一套完全自由免费，兼容于Unix的操作系统GNU(`GNU's Not Unix!`)
- Stallman于1989年与一群律师起草了广为使用的`GNU通用公共协议证书(GNU GPL)`
- GNU项目有许多高质量的免费软件，例如：
    - emacs编辑系统
    - bash shell程序
    - gcc系列编译程序
    - gdb调试程序等等

### linux简介

- Linux前身是`MINIX系统`，是由Andrew S. Tanenbaum于1987年开发的，主要用于学生学习操作系统原理

- `MINIX操作系统`是**UNIX的一种克隆系统**，由于MINIX系统提供源代码(免费用于大学内)，在全世界的大学中都开始学习UNIX系统

- 1991年芬兰大学生李纳斯在`GPL条例`下发布他自己创作的Linux操作系统内核，至此GNU计划正式完成，操作系统被命名为`GNU/Linux(或简称Linux)`

- `Linux`只是**一个内核**，GNU软件为Linux操作系统的开发创造了一个合适的环境，因此Linux操作系统被称为`GNU/Linux`

- `Linux`同样是**UNIX的一种克隆系统**，是一种**准(类)UNIX**

- 其他相关简介

    <img src="./Images/3.1 Linux其他简介.png" style="zoom:60%;" alt="Linux其他简介" />

## 3.2 Linux命令

### 常用命令

1. 关机命令`shutdown`
2. 广播命令`wall`，发送通知信息
3. 退出服务器或当前用户命令`exit`
4. 修改用户口令命令`passwd`
5. 查看当前用户命令`who`
6. 在终端显示字符串命令`echo`
7. 显示或设置日期或时间命令`date`
8. 清除当前屏幕显示内容命令`clear`

### 文件与目录命令

1. 查看当前目录下的文件命令`ls`
2. 查看文件内容命令`cat`
3. 
4. 文件权限设定命令`chmod`，`chmod [-R] mode name`
    1. mode：3个
    2. 例子：
        1. `chmod 755 dir1`：755对应的二进制数是：`111，101，101`，按顺序对应`u, g, o`，每一组内又按顺序对应rwx
        2. `chmod u+x file2`：给`file2`的文件拥有者增添`x`权限
        3. `chmod o-r file3`：给`file3`的其他用户减去`r`权限
        4. `chmod a+x file4`：给`file4`的文件拥有着增添`x`权限，**存在问题**

### 帮助命令

1. 帮助`help`
2. 帮助命令`man`
3. 给出命令功能信息的命令`whatis`

### 其他命令

## 3.3 编译工具链

### 一个程序的编译过程

1. 预处理：Pre-process，`gcc -E hello.i hello.c`
2. 编译：Compile，`gcc -S -o hello.s hello.i`
3. 汇编：Assemble，`gcc -c -o hello.o hello.s`
4. 链接：Link，`gcc -o hello hello.o`

### hello world的编译过程

1. `gcc -o hello hello.c`，一步完成，输入文件是`text`，输出文件是`text`
    1. `gcc -c -o hello.o hello.c`，一步完成到汇编，输入文件是`text`，输出文件是`binary`
        1. `gcc -S -o hello.s hello.c`，一步完成到编译，输入文件是`text`，输出文件是`text`
            1. `gcc -E hello.i hello.c`，预处理，输入文件是`text`，输出文件是`text`
            2. `gcc -S -o hello.s hello.i`，编译，输入文件是`text`，输出文件是`text`
        2. `gcc -c -o hello.o hello.s`，汇编，输入文件是`text`，输出文件是`binary`
    2. `gcc -o hello hello.o`，链接，输入文件是`binary`，输出文件是`binary`

### 文件扩展名

<img src="./Images/3.3 编译工具链 - 文件扩展名.png" style="zoom:60%;" alt="编译工具链 - 文件扩展名" />

- 需要预处理源码：.c、.cc
- 不需预处理源码：.i、.ii
- 需要预处理的汇编代码：.S
- 不需预处理的汇编代码：.s
- 目标文件：.o
- 静态库：.a
- 动态库：.so
- linux编译和链接生成的默认文件名是a.out

9月30日

***

### GNU工具链

- GNU工具链
    - GCC编译器
        - GNU的c和c++编译器，如gcc-2.95.3.tar.gz
        - gcc是编译的前端程序，编译时可依次调用cpp、cc1、as等工具完成编译
        - gcc具有丰富的命令选项，如
            - `-o`
            - `-c`
            - `-L(指定库所在目录)`
            - `-l(指定库文件)`
            - `-I(指定头文件目录)`
            - `-O(指定编译时的优化级别)`
    - binutils二进制工具，例如binutils-2.11.2.tar.gz。主要包括
        - 连接器`ld`
        - 汇编代码编译器`as`
        - 库管理器`ar`
        - 等等
    - glibc库函数
        - C函数库
        - Linux函数库
        - 如glibc-2.2.3.tar.gz和glibc-linuxthreads-2.2.3.tar.gz

#### 编译工具链——库管理器`ar`

- Linux下的函数库
    - 静态函数库：用`.a`作为文件的后缀，生成目标代码时会被加入到其中，**生成代码体积大，速度快**
    - 共享函数库：存放可执行程序在运行的时候才会被加载的函数，后缀是`.so`及版本号信息，**生成代码可以共享**，便于升级
    - 函数库名字必须`lib`作为前缀，如：`libgui.so.1`

- 库管理器`ar`

    - `ar`用于生成静态函数库，可以将**多个可重定位**的目标模块归档位**一个函数库文件**
- 基本格式：`ar [-dmpqrtx][cfosSuvV][a<成员文件>][b<成员文件>][i<成员文件] [库文件] [成员文件]`
    - `ar`命令能够建立函数库，能够针对库中成员完成添加、删除或取出、调整次序及显示等操作

#### 编译工具链——gdb调试器

##### gdb功能

- 使你能监视程序中变量的值
- 使你能设置断点以使程序在指定的代码行上停止执行
- 使你能一行行的执行你的代码

##### gdb命令

- `file`装入想要调试的可执行文件
- `kill`终止正在调试的程序
- `list`列出产生执行文件的源代码的一部分
- `next`执行一行源代码但不进入函数内部
- `step`执行一行源代码而且进入函数内部
- `run`执行当前被调试的程序
- `quit`终止
- `gdbwatch`使你能监视一个变量的值而不管它何时被改变
- `break`在代码里设置断点, 这将使程序执行到这里时被挂起
- `make`使你能不退出 gdb 就可以重新产生可执行文件
- `shell`使你能不离开 gdb 就执行 Linux shell 命令

## 3.4 使用实例



## 3.5 make与makefile（考试5分）



10月5日，3-5，3-6PPT第10页

***

## 3.6 shell编程（考试5分）

### 基本介绍



### 多种不同的版本

- sh: GNU Bourne Shell



### 4种变量

#### 用户变量

#### 环境变量

#### 位置变量

##### 位置变量

##### shift命令

#### 预定义变量

##### $#变量

##### $*变量

##### $@变量

##### $?变量

### 特殊字符

#### 3种通配符

- `*`，星号，它匹配
- `?`，问号，匹配任意一个字符，
- `[]`，一对方括号，
    - `*`和`?`，星号和问号在方括号内，就不是通配符了
- `!`，叹号，

#### 引号与反斜线

- `""`，
- `''`，
- `/`/``，反引号
- `\`，反斜线

### 表达式

#### 逻辑表达式

#### Expr求值表达式

#### 条件判断——if表达式

##### test命令

##### 整数比较操作符：知道即可，即用即查

| 操作符 | 返回真的条件 |
| ------ | ------------ |
|        |              |
|        |              |
|        |              |
|        |              |
|        |              |
|        |              |

##### 字串测试操作符：知道即可，即用即查

| 操作符 | 返回真的条件 |
| ------ | ------------ |
|        |              |
|        |              |
|        |              |
|        |              |

##### 一元文件操作符：知道即可，即用即查

| 操作符 | 返回真的条件 |
| ------ | ------------ |
|        |              |
|        |              |
|        |              |
|        |              |
|        |              |
|        |              |
|        |              |
|        |              |

##### case表达式

##### for循环

##### while循环



2>/dev/null

2是linux的标准错误号，null是一个不存在的设备
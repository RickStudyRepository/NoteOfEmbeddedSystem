# 2 嵌入式系统硬件平台

## 2.1 嵌入式系统硬件平台概述

### 2.1.1 整体构架

#### 台式计算机硬件平台整体构架

#### 嵌入式系统硬件平台整体构架

##### 作业：看门狗和实时时钟是什么？

###### 看门狗（Watchdog）

**我的理解**：

- 概念：看门狗实际上就是一个计时器，用来确保系统能在出现问题时可以自行恢复，恢复的方式包括但不限于：

    1. 将系统置到安全状态，重置系统操作
    2. 芯片级别的重置

- 功能：仅仅是一种可能的情况，系统在执行正常操作时会不断重置看门狗计时器，当系统出现问题时，不能重置看门狗计时器，计时器会在超时后发出超时信号，使系统自动恢复

> - [WikiPedia](https://en.wikipedia.org/wiki/Watchdog_timer)：A **watchdog timer** (sometimes called a *computer operating properly* or *COP* timer, or simply a *watchdog*) is an electronic or software [timer](https://en.wikipedia.org/wiki/Timer) that is used to **detect and recover from computer malfunctions**. During normal operation, the computer regularly resets the watchdog timer to prevent it from elapsing, or "timing out". If, due to a hardware fault or program error, the computer **fails to reset the watchdog**, the timer will **elapse and generate a timeout signal**. The timeout signal is used to initiate corrective actions. The corrective actions typically include placing the computer system in a safe state and restoring normal system operation.
>
> - [Gateworks](http://trac.gateworks.com/wiki/watchdog)：Gateworks boards provide both a hardware boot watchdog timer that power cycles the board if boot firmware failed to run as well as SoC watchdogs.
>
>     - **Ventana (imx6) CPU watchdog**：The IMX6 SoC watchdog has an 8bit timeout configuration ranging from 500ms to 128s in 500ms intervals and will issue a **chip-level SoC reset**. On some boards an external output can also be present to reset other peripherals(外围设备).

###### 实时时钟（RTC，Real Time Clock）

**我的理解**：

- 概念：顾名思义，就是记录当前时间的时钟，通常是集成芯片的形态，与只会产生时钟信号的硬件时钟（hardware clocks）不同，实时时钟按照人类的计时方式计时
- 功能：持续跟踪记录实时时间

> - [WikiPedia](https://en.wikipedia.org/wiki/Real-time_clock)：A **real-time clock** (**RTC**) is a [computer](https://en.wikipedia.org/wiki/Computer) [clock](https://en.wikipedia.org/wiki/Clock) (most often in the form of an [integrated circuit](https://en.wikipedia.org/wiki/Integrated_circuit)) that keeps track of the current [time](https://en.wikipedia.org/wiki/Time). Although the term often refers to the devices in [personal computers](https://en.wikipedia.org/wiki/Personal_computer), [servers](https://en.wikipedia.org/wiki/Server_(computing)) and [embedded systems](https://en.wikipedia.org/wiki/Embedded_system), RTCs are present in almost any electronic device which needs to keep accurate time.
>
>     **Purpose**：
>
>     - Low power consumption (important when running from alternate power)
>     - Frees the main system for time-critical tasks
>     - Sometimes more accurate than other methods

### 2.1.2 两类嵌入式主机板

#### 一体式主机板

1. 嵌入到设备中使用
2. 有固定的功能和应用领域，更具专用性，一般不需要再改变
3. 适合在一定批量和通用性的嵌入式产品中使用，如PMD主机板就是这种类型的代表

#### 核心式主机板

1. 只包含核心硬件，相当于基于嵌入式处理器的最小系统，使用时通过外围板扩展功能
2. 占位
3. 占位
4. 占位
5. 占位
6. 占位
7. zw

### 2.1.3 编程模式

#### 片内接口

1. 片内接口的编程通过操作嵌入式处理器内部一组**特殊寄存器**完成，本课程称为`特殊功能寄存器SFR`（三星处理器约定称谓）
2. 片内接口的使用按照嵌入式处理器规定好的方式进行，其使用可参见**嵌入式处理器**的数据手册

#### 片外接口

1. 外部接口则与外部总线相连，通过端口进行操作
2. 片外接口使用方式按照**外部接口**采用的接口芯片或电路进行

### 2.1.4 可配置的引脚

#### 引脚的复用

1. 嵌入式处理器内部提供了大量的I/O接口，每种I/O接口都有自己独立的引脚同外部设备连接
2. 这会引起外部引脚数量的大量增加，从而增大处理器芯片的体积
3. 嵌入式处理器采用复用引脚，即**一脚多用**的方法来解决这个问题
4. 这样，每个引脚都有多个功能，只在**需要时才配置成对应功能**

##### 引脚复用的例子

1. S3C2410处理器每个引脚最多可以复用4个功能
2. IMX6处理器每个引脚最多可以复用8个功能

#### GPIO引脚

1. 最简单的外设就是开关量装置，所以通常嵌入式系统中可配置的复用引脚功能中至少都包含有**通用目的的输入输出(GPIO)**
2. 这种引脚被称为GPIO引脚，在不需要设置为其它专用外设引脚的时候，至少可以配置为使用量最大的输入和输出功能，以利于充分利用引脚资源

## 2.2 基于IMX6的最小系统

### 2.2.1 IMX6处理器

#### 基本介绍

1. 运行频率高达1.2GHz，包括单核、双核、四核产品
2. 内部含有32KB的一级指令和数据缓存、256KB到1MB的二级缓存
3. 支持1080P60解码、1080P30编码和高清视频播放，出色的3D图形性能支持OpenCL
4. 96K启动ROM、16K加密RAM、128个GPIO口
5. 独立2D/3D加速引擎，支持立体图像传感器3D成像，支持高仿真3D游戏
6. 集成HDMI、SD、USB 2.0、千兆以太网、SATA、PCIe、MIPI及FlexCAN
7. 全面的安全功能，包括密码算法加速器、高可靠性引导程序和防篡改保护
8. 占位
9. 占位

#### 处理器平台

<img src="./Images/2.2.1 处理器平台.png" style="zoom:60%;" />

1. 内核Cortex-A9
2. 每个核32K指令Cache（I Cache）
3. 每个核32K数据Cache（D Cache）
4. 每个核128位SIMD扩展结构
5. 每个核的程序跟踪宏单元（调试用）
6. 256k-1M二级cache

#### 内部接口

<img src="./Images/2.2.1 内部接口.png" style="zoom:60%;" />

1. MMC/SD卡接口
2. 异步串行口
3. IIC及SPI接口
4. 占位
5. 占位
6. 占位
7. 占位
8. 占位
9. 占位

#### 多媒体及显示

#### 系统控制及其它

1. 系统控制
    1. JTAG调试口
    2. 锁相环，晶振：矩形波的来源
    3. 时钟及复位
    4. DMA接口
    5. IO多路选择
    6. PWM
    7. 看门狗
2. 电源管理
    1. 电源供给
    2. 温度监控
3. 内部存储器
4. 安全支持
    1. 随机数发生器
    2. 安全控制器
    3. 可信区
    4. 实时时钟
    5. 密码
    6. 3840位一次性ROM

**9月21日**

***

### 2.2.2 主存储器

### 2.2.3 辅助存储器

### 2.2.4 时钟&电源





